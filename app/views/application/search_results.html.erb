<!-- Search results page -->
<% if session['logged_in'] == 1 %>
	<%= render 'navbar_others' %>
<% else %>
	<%= render 'navbar_unlogged' %>
<% end %>

<div>
<!-- Display error message if the search has returned no results. -->
<% if @no_results %>
<h2>The search has returned no results. Try something else.</h2>
<% else %>
<h2>No. search results: <%= @track_results.count + @user_results.count %></h2>
<% end %>

<!-- Display all tracks and users -->
	<% @track_results.each do |track| %>
	    <% rating = ratings track.id %>
		<div class="col-md-4">
	      	<div class="col-md-6">
	      	<% if track.image_path.nil? == false or track.image_path.length > 0 %>
	      		<%= image_tag("mediaimage/#{track.image_path}", id:"content-img", alt:"Track image", size: "150x150") %>
	      	<% else %>
	      		<%= image_tag("mediaimage/musicnote.png", id:"content-img", alt:"Track image", size: "150x150") %>
	      	<% end %>
          </div>
	      	<div class="col-md-6 content-info">
	      		<p class="h4 row info track-name"><%="Track: " + track.title %></p>
	      		<% if Music.find_by(id:track.id).nil? == false %>
	      		<p class="h4 row info track-name"><%="Genre: " + Music.find(track.id).genre %></p>
	      		<% end %>
	      		<p class="h4 row info track-name">Creator: 
	      		<%= link_to User.find(track.user_id).username, controller:"profile", action:"showOther", :id => track.user_id %></p>
	  			<p class="h4 row info track-name">Plays:<%=track.music.plays%></p>
	  			<p class="h4 row info track-name"><a onclick="parent.jplayer_load('<%= track.title %>','<%=track.file_path%>', '<%=track.image_path%>', '<%=track.user.username%>', '<%=track.user.id%>', '<%= rating %>', '<%=track.music.plays%>')"><img class="playtrack-search" src="assets/images/play.png">
	  			<a href="/comments/music/?id=<%=track.music.id%>"><img class="comment-search" src="assets/images/comment.ico"></a></p>
	  			<p class="h4 row info track-name">
	  				<% if rating <= 0.5 %>
            		<img src="/assets/images/0.5.png" class="rating">
           	    <% elsif rating <= 1 %>
               	    <img src="/assets/images/1.0.png" class="rating">
          	    <% elsif rating <= 1.5 %>
               	    <img src="/assets/images/1.5.png" class="rating">
                <% elsif rating <= 2 %>
                    <img src="/assets/images/2.0.png" class="rating">
                <% elsif rating <= 3 %>
                    <img src="/assets/images/3.0.png" class="rating">
                <% elsif rating <= 3.5 %>
                    <img src="/assets/images/3.5.png" class="rating">
                <% elsif rating <= 4 %>
                   <img src="/assets/images/4.0.png" class="rating">
                <% elsif rating <= 4.5 %>
                   <img src="/assets/images/4.5.png" class="rating">
                <% else %>
                   <img src="/assets/images/5.0.png" class="rating">
                <% end %>
	      	</p>
	      	</div>
        </div>  
	<% end %>
	<% @user_results.each do |key, value| %>
		<div class="col-md-4">
	      	<div class="col-md-6">
	      	<% if User.find(key).image_path.nil? == false %>
	      		<%= image_tag("userimage/#{User.find(key).image_path}", id:"content-img",  alt:"User image", size: "150x150") %>
	      	<% else %>
	      		<!-- Select at random default picture. -->
	      		<% index = rand(0..3) %>
	      		<% files = ['yellow.jpg', 'blue.jpg', 'green.jpg', 'red.jpg'] %>
	      		<%= image_tag("userimage/#{files[index]}", id:"content-img",  alt:"User image", size: "150x150") %>
	      	<% end %>
          	</div>
	      	<div class="col-md-6 content-info">
	      		<p class="h4 row info track-name"> User: 
	      		<%= link_to value, controller:"profile", action:"showOther", :id => key %>
	      		<% if User.find(key).website_link.nil? == false %></p>
	      		<p class="h4 row info track-name">Website: <%= link_to User.find(key).website_link.to_s, User.find(key).website_link, :target => '_blank' %></p>
	      		<% end %>
	      		<p class="h4 row info track-name"><%= "Followers ("+Follower.where(user_id:key).count.to_s+")" %></p>
	      	</div>
        </div>  
	<% end %>
</div>